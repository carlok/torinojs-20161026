<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>hapi.js - </title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/black.css" id="theme">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <!--
    1 + N shell (nodemon & http)
    3 chrome tab (slide, swagger & bitbucket)
    1 sublime
    -->
    <div class="slides">
        <section>
            <h1>hapi.js</h1>
            <h2>An introduction</h2>
            <h3><a href="http://torino.js.org/">TorinoJS</a> - 2016-10-26</h3>
            <p>
                <small>Speaker: Carlo Perassi / <a href="http://twitter.com/karlok">@karlok</a></small>
            </p>
        </section>

        <section>
            <h2>Introduction</h2>
            <ul>
                <li class="fragment">Thanks to Giorgio Cerruti and Marco Becchio</li>
                <li class="fragment"><a href="http://kiwifarm.it">Kiwifarm Srl</a>: three services in production ATM
                    <span class="fragment">&#9733;</span>
                </li>
                <li class="fragment">Are you a freelance? Feel free to contact me &#9787;</li>
            </ul>
        </section>

        <section>
            <h2>hapi.js: a few notes (1/2)</h2>
            <ul>
                <li class="fragment">ECMAScript 2015 Node.js framework (not Express based!) mostly
                    used for creating REST services
                </li>
                <li class="fragment">Robust, stable, reliable and not (so) opinionated <span class="fragment">(<a
                        href="http://www.walmartlabs.com/innovation/open-source/">@WalmartLabs</a>)</span></li>
                <li class="fragment">Security is a key consideration</li>
            </ul>
        </section>

        <section>
            <img src="http://www.mememaker.net/static/images/memes/4674316.jpg"/>
        </section>

        <section>
            <h2>hapi.js: a few notes (2/2)</h2>
            <p>Logical modularization<br/><span class="fragment">&rArr;<br/>Small modules</span><br/><span
                    class="fragment">&rArr;<br/>Less pain</span></p>
        </section>

        <section>
            <h2>Book</h2>
            <p>Getting Started with hapi.js</p>
            <a href="https://gettingstartedwithhapijs.com/"><img
                    src="https://gettingstartedwithhapijs.com/img/book_cover.jpg"></a>
        </section>

        <section>
            <h2>Plugin based</h2>
            <blockquote>
                &ldquo;hapi enables developers to focus on writing reusable application logic instead of spending time
                building infrastructure&rdquo;
            </blockquote>
            (<a href="http://hapijs.com">hapi.js</a> website)
        </section>

        <section>
            <h2>A very basic plugin</h2>
            <pre class="fragment">
                <code class="data-trim contenteditable javascript">
exports.register = function (server, options, next) {
    const sayHello = function (name = 'world') {
        return `Hello ${name}`;
    };
    server.expose({
        sayHello: sayHello,
    });

    next();
};
exports.register.attributes = {
    name: 'greeting'
};
// usage: server.plugins.greeting.sayHello('Carlo')
                </code>
            </pre>
        </section>

        <section>
            <h2>Ecosystem</h2>
            <p>To name a few:</p>
            <ul>
                <li class="fragment"><a href="https://github.com/hapijs/boom">boom</a> (HTTP-friendly error objects)
                </li>
                <li class="fragment"><a href="https://github.com/hapijs/good">good</a> (process monitoring and logging)
                </li>
                <li class="fragment"><a href="https://github.com/glennjones/hapi-swagger">hapi-swagger</a> (guess it)
                </li>
                <li class="fragment"><a href="https://github.com/dwyl/hapi-auth-jwt2">hapi-auth-jwt2-swagger</a> (guess
                    it once again)
                <li class="fragment"><a href="https://github.com/hapijs/joi">joi</a> (object schema validation)</li>
                </li>
            </ul>

            <p class="fragment">The whole pack at <a href="http://hapijs.com/plugins">hapijs.com/plugins</a></p>
        </section>

        <section>
            <h2>Three fine features</h2>
            <ul>
                <li class="fragment">Linting</li>
                <li class="fragment">Testing</li>
                <li class="fragment">Code coverage</li>
            </ul>
        </section>

        <section>
            <h2>Ok, show me the code</h2>
            <p><span class="fragment"><a href="https://github.com/carlok">github.com/carlok</a></span></p>
            <ul>
                <li class="fragment">code: <a class="fragment" href="https://github.com/carlok/hto">/hto</a>
                </li>
                <li class="fragment">presentation: <a class="fragment"
                                                      href="https://github.com/carlok/torinojs-20161026">/torinojs-20161026</a>
                </li>
            </ul>
        </section>

        <section>
            <h2>It's&hellip;<br/><span class="fragment">stretching time</span></h2>
            <img class="fragment" data-src="https://media.giphy.com/media/xT9DPlbvIe2POSISM8/giphy.gif"/>
        </section>

        <section>
            <h2>Demo (1)</h2>
            <pre class="fragment">
                <code class="data-trim contenteditable bash">
# GET /api/v1/users/token_free
http localhost:1337/api/v1/users/token_free -j --verbose
# show the code
                </code>
            </pre>
            <pre class="fragment">
                <code class="data-trim contenteditable bash">
# POST /api/v1/users/login
http POST localhost:1337/api/v1/users/login \
                    username=carlo@aaa.it password=qqq -j --verbose
# {success, failure} then show the code
                </code>
            </pre>
        </section>

        <section>
            <h2>Demo (2)</h2>
            <pre class="fragment">
                <code class="fragment data-trim contenteditable bash">
# GET /api/v1/users/restricted
http --auth-type=jwt --auth='{token}:' -j --verbose \
                    localhost:1337/api/v1/users/restricted
# {success, failure} then show the code
                </code>
            </pre>
            <pre class="fragment">
                <code class="data-trim contenteditable javascript">
console.log(require('crypto').randomBytes(256).toString('base64'))
                </code>
            </pre>
        </section>

        <section>
            <h2>Demo (3)</h2>
            <pre class="fragment">
                <code class="data-trim contenteditable bash">
# GET /documentation # (swagger's web interface)
# GET /api/v1/users/foo/{imei}
                </code>
            </pre>
            <pre class="fragment">
                <code class="data-trim contenteditable bash">
# AMQP and folders
# hidden demo :)
                </code>
            </pre>
        </section>

        <section>
            <h2>Demo (4)</h2>
            <pre class="fragment">
                <code class="data-trim contenteditable bash">
# Linting
./node_modules/lab/bin/lab --lint --lint-fix lib/
                </code>
            </pre>
            <pre class="fragment">
                <code class="data-trim contenteditable bash">
# Testing and code coverage
./node_modules/lab/bin/lab -C -c -v test/
                </code>
            </pre>
        </section>

        <section>
            <h2>Further studies - &#9733;&#9734;&#9734;</h2>
            <p>
                <span class="fragment"><a
                        href="https://github.com/rocky-jaiswal/hapi-knex-starter">hapi-knex-starter</a></span><br/>
                <span class="fragment">JWT-ready starter project based on<br/>hapi.js and <a href="http://knexjs.org/">Knex.js</a> (promised SQL query builder)</span>
            </p>
        </section>

        <section>
            <h2>Further studies - &#9733;&#9733;&#9734; (1/5)</h2>

            <img class="fragment" height="240" src="http://freecontent.manning.com/wp-content/uploads/h.gif"/>
            <p class="fragment">(<a href="https://www.manning.com/books/hapi-js-in-action">hapi.js in Action</a>)</p>
        </section>

        <section>
            <h2>Further studies - &#9733;&#9733;&#9734; (2/5)</h2>

            <img class="fragment" height="240"
                 src="http://blog-assets.risingstack.com/2014/12/hapi_request_lifecycle.png"/>
            <p class="fragment">(<a href="https://blog.risingstack.com/getting-started-with-hapi-8/">Getting Started
                with Hapi 8</a>)</p>
        </section>

        <section>
            <h2>Further studies - &#9733;&#9733;&#9734; (3/5)</h2>

            <pre class="fragment">
                <code class="data-trim contenteditable javascript">
server.route({ method: 'GET', path: '/',
    config: {
        pre: [
            [   { method: pre1, assign: 'm1' },
                { method: pre2, assign: 'm2' } ],
            { method: pre3, assign: 'm3' },
        ],
        handler: function (request, reply) {
            return reply(request.pre.m3 + '\n');
        }
    }
});
                </code>
            </pre>
            <p class="fragment">See <a href="http://stackoverflow.com/a/38909177">S.O.</a></p>
        </section>

        <section>
            <h2>Further studies - &#9733;&#9733;&#9734; (4/5)</h2>

            <pre class="fragment">
                <code class="data-trim contenteditable javascript">
server.route({
    method: 'GET', path: '/admin',
    handler: function(request, reply) {},
    config: {
        plugins: {
            policies: [ ['isA', 'isB'], /* 2 in || */ 'onlyC' ]
        }
    }
});
                </code>
            </pre>
            <p class="fragment">(<a href="https://github.com/mark-bradshaw/mrhorse">MrHorse</a>)</p>
        </section>

        <section>
            <h2>Further studies - &#9733;&#9733;&#9734; (5/5)</h2>

            <pre class="fragment">
                <code class="data-trim contenteditable javascript">
  {
    method: 'DELETE',
    path: '/cars/{id}',
    config: {
      handler: function(request, reply) { reply('car deleted!'); },
      plugins: { hapiRouteAcl: { permissions: ['cars:delete'] } }
    }
  },
                </code>
            </pre>
            <p class="fragment">(<a href="https://github.com/eventhough/hapi-route-acl">Hapi Route ACL</a>)</p>
        </section>

        <section>
            <h2>Further studies - &#9733;&#9733;&#9733; (1/4)</h2>
            <p>Decorators (not that one)</p>

            <img height="320"
                 src="http://www.constructionsupport.co.uk/guide/wp-content/uploads/2013/09/painter-and-decorator-cscs-test-640x430.jpg"/>
        </section>

        <section>
            <h2>Further studies - &#9733;&#9733;&#9733; (2/4)</h2>
            <p>yeah, this one</p>

            <img src="https://s22.postimg.org/r4v193svl/400px_Decorator_UML_class_diagram_svg.jpg"/>
        </section>

        <section>
            <h2>Further studies - &#9733;&#9733;&#9733; (3/4)</h2>

            <pre class="fragment">
                <code class="data-trim contenteditable javascript">
@controller('/hello')
class TestController {
  constructor(target) {
    this.target = target
  }
  @get('/world')
  sayHello(request, reply) {
    reply({ message: `hello, ${this.target}` })
  }
}
                </code>
            </pre>
            <a class="fragment" href="https://github.com/knownasilya/hapi-decorators">hapi-decorators</a>
        </section>

        <section>
            <h2>Further studies - &#9733;&#9733;&#9733; (4/4)</h2>

            <p class="fragment">
                Yes, TypeScript:<br/>
                <a href="https://github.com/dwyl/hapi-typescript-example">github.com/dwyl/hapi-typescript-example</a>
            </p>
        </section>

        <section>
            <h2>Thanks!</h2>
            <h3 class="fragment">Questions?</h3>
            <img class="fragment" height="360"
                 src="http://arcatamassage.com/wp-content/uploads/2014/09/Girl-with-Hand-Raised-2010-112.jpg"/>
        </section>
    </div>

</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>

    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
            {
                src: 'lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/highlight/highlight.js', async: true, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            },
            {src: 'plugin/zoom-js/zoom.js', async: true},
            {src: 'plugin/notes/notes.js', async: true}
        ]
    });

</script>

</body>
</html>
